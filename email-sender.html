<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Sender - Student ID Distribution</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            padding: 40px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            width: 100px;
            height: auto;
            margin-bottom: 20px;
            border-radius: 8px;
        }

        h1 {
            color: #1e40af;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #6b7280;
            font-size: 16px;
            margin-bottom: 30px;
        }

        .instructions {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .instructions h3 {
            color: #1e40af;
            margin-bottom: 10px;
        }

        .instructions ol {
            margin-left: 20px;
            line-height: 1.6;
            color: #374151;
        }

        .student-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .student-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
        }

        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .student-name {
            font-weight: 600;
            color: #111827;
        }

        .student-id {
            background: #1e40af;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            color: #374151;
            font-weight: 500;
            margin-bottom: 5px;
            font-size: 14px;
        }

        input[type="email"], input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }

        input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .email-preview {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 15px;
            font-size: 12px;
            line-height: 1.4;
            color: #374151;
            max-height: 200px;
            overflow-y: auto;
        }

        .email-subject {
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #1e40af;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-success {
            background: #059669;
            color: white;
        }

        .btn-success:hover {
            background: #047857;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .success-message {
            background: #d1fae5;
            border: 1px solid #6ee7b7;
            color: #065f46;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6b7280;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            .student-inputs {
                grid-template-columns: 1fr;
            }

            .buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="images/Logo-CLM-V1.jpg" alt="Logo CLM" class="logo">
            <h1>Student ID Email Sender</h1>
            <p class="subtitle">Producci√≥n Oral B2.1 - Universidad de Granada</p>
        </div>

        <div class="instructions">
            <h3>üìß Instructions:</h3>
            <ol>
                <li><strong>Enter student emails</strong> in the fields below</li>
                <li><strong>Preview personalized emails</strong> for each student</li>
                <li><strong>Copy email content</strong> and send via your preferred email client</li>
                <li><strong>Track sent status</strong> with the checkboxes</li>
            </ol>
            <p style="margin-top: 10px; color: #6b7280;">
                <strong>Note:</strong> This system generates personalized emails that you can copy-paste into Gmail, Outlook, etc.
            </p>
        </div>

        <div class="student-inputs" id="studentInputs">
            <!-- Student cards will be generated here -->
        </div>

        <div class="success-message" id="successMessage">
            ‚úÖ All emails prepared successfully! You can now copy and send each email individually.
        </div>

        <div class="buttons">
            <button class="btn btn-primary" onclick="generateAllEmails()">
                üìß Generate All Emails
            </button>
            <button class="btn btn-success" onclick="copyAllEmails()">
                üìã Copy All Content
            </button>
            <button class="btn btn-secondary" onclick="window.open('attendance-admin.html', '_blank')">
                üìä Go to Admin Panel
            </button>
            <button class="btn btn-secondary" onclick="window.open('student-ids-reference.html', '_blank')">
                üîç View Student Reference
            </button>
        </div>
    </div>

    <!-- Modal for email preview -->
    <div class="modal" id="emailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Email Preview</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody">
                <!-- Email content will be shown here -->
            </div>
        </div>
    </div>

    <script>
        // Students data with IDs and variants
        const STUDENTS_DATA = [
            {
                id: '1523',
                fullName: 'BAI, MIAORUI',
                variants: ['Miaorui Bai', 'Miaorui', 'M. Bai', 'Bai']
            },
            {
                id: '2847',
                fullName: 'CHAFFIN, NATHANIEL HAYEN',
                variants: ['Nathaniel Chaffin', 'Nathaniel', 'N. Chaffin', 'Nat', 'Chaffin']
            },
            {
                id: '3915',
                fullName: 'DIAZ, ANGELA CLARICE',
                variants: ['Angela Diaz', 'Angela', 'A. Diaz', 'Diaz']
            },
            {
                id: '4602',
                fullName: 'KEMPF, RYAN ELIZABETH',
                variants: ['Ryan Kempf', 'Ryan', 'R. Kempf', 'Kempf']
            },
            {
                id: '5789',
                fullName: 'LANTER, WESLEY MITCHELL',
                variants: ['Wesley Lanter', 'Wesley', 'W. Lanter', 'Lanter']
            },
            {
                id: '6134',
                fullName: 'MANCIPE, GABRIEL FELIPE',
                variants: ['Gabriel Mancipe', 'Gabriel', 'G. Mancipe', 'Mancipe']
            },
            {
                id: '7256',
                fullName: 'MIRANDA, MARISOL ESPERANZA',
                variants: ['Marisol Miranda', 'Marisol', 'M. Miranda', 'Miranda']
            },
            {
                id: '8901',
                fullName: 'MOREY, GABRIELLE KAI',
                variants: ['Gabrielle Morey', 'Gabrielle', 'G. Morey', 'Morey', 'Kai']
            },
            {
                id: '9467',
                fullName: 'PORTZLINE, EVAN GRACE',
                variants: ['Evan Portzline', 'Evan', 'E. Portzline', 'Portzline']
            },
            {
                id: '1089',
                fullName: 'SALAZAR, NATALIE',
                variants: ['Natalie Salazar', 'Natalie', 'N. Salazar', 'Salazar']
            }
        ];

        function initializeStudentInputs() {
            const container = document.getElementById('studentInputs');

            STUDENTS_DATA.forEach((student, index) => {
                const card = document.createElement('div');
                card.className = 'student-card';
                card.innerHTML = `
                    <div class="student-header">
                        <div class="student-name">${student.fullName}</div>
                        <div class="student-id">ID: ${student.id}</div>
                    </div>

                    <div class="form-group">
                        <label for="email-${index}">Student Email:</label>
                        <input type="email" id="email-${index}" placeholder="student@ugr.es">
                    </div>

                    <div class="form-group">
                        <label>Email Preview:</label>
                        <div class="email-preview" id="preview-${index}">
                            <div class="email-subject">Subject: Your Attendance ID for Spanish Oral Course B2.1</div>
                            <em>Enter email address to see personalized content...</em>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="checkbox" id="sent-${index}" onchange="updateProgress()">
                        <label for="sent-${index}" style="margin: 0; font-size: 14px;">Email sent</label>
                        <button class="btn btn-primary" style="padding: 6px 12px; font-size: 14px;" onclick="previewEmail(${index})">
                            üëÅÔ∏è Preview
                        </button>
                        <button class="btn btn-success" style="padding: 6px 12px; font-size: 14px;" onclick="copyEmail(${index})">
                            üìã Copy
                        </button>
                    </div>
                `;

                container.appendChild(card);

                // Add email input listener
                document.getElementById(`email-${index}`).addEventListener('input', () => {
                    generateEmailPreview(index);
                });
            });
        }

        function generateEmailContent(student, email) {
            const subject = `Your Attendance ID for Spanish Oral Course B2.1`;

            const body = `Dear ${student.fullName.split(',')[1] || student.fullName.split(',')[0]},

Welcome to the Spanish Oral Production Course B2.1 at Universidad de Granada!

I'm writing to provide you with your personal attendance ID for our course. This ID will be used to register your attendance in class each day.

üéØ **Your Personal Information:**
‚Ä¢ Full Name: ${student.fullName}
‚Ä¢ Student ID: ${student.id}
‚Ä¢ Accepted Name Variants: ${student.variants.join(', ')}

üì± **How to Register Your Attendance:**

1Ô∏è‚É£ **Scan the QR Code**:
   - Look for the QR code displayed in class
   - Use your phone's camera to scan it
   - It will open the attendance page

2Ô∏è‚É£ **Fill the Form**:
   - Enter your name (you can use any of the variants listed above)
   - Enter your 4-digit Student ID: ${student.id}
   - Click "Registrar Asistencia"

3Ô∏è‚É£ **Confirmation**:
   - You'll see a success message with your registration details
   - The system records the exact time of your arrival
   - You can only register once per day

‚ö†Ô∏è **Important Notes:**
‚Ä¢ Your ID is unique and confidential - don't share it with others
‚Ä¢ You must use BOTH your name (any accepted variant) AND your correct ID
‚Ä¢ The system works with mobile data - no WiFi needed
‚Ä¢ Make sure to register when you arrive at class

üîß **If you have any issues:**
- Double-check that you're using the correct 4-digit ID
- Try using a different name variant from the list above
- Contact me if you need assistance

I look forward to seeing you in class!

Best regards,
Javier Ben√≠tez L√°inez
Spanish Language Professor
Centro de Lenguas Modernas
Universidad de Granada`;

            return { subject, body };
        }

        function generateEmailPreview(index) {
            const email = document.getElementById(`email-${index}`).value;
            const preview = document.getElementById(`preview-${index}`);
            const student = STUDENTS_DATA[index];

            if (!email) {
                preview.innerHTML = '<div class="email-subject">Subject: Your Attendance ID for Spanish Oral Course B2.1</div><em>Enter email address to see personalized content...</em>';
                return;
            }

            const { subject, body } = generateEmailContent(student, email);

            preview.innerHTML = `
                <div class="email-subject">Subject: ${subject}</div>
                <div style="white-space: pre-line;">${body}</div>
            `;
        }

        function previewEmail(index) {
            const email = document.getElementById(`email-${index}`).value;
            const student = STUDENTS_DATA[index];

            if (!email) {
                alert('Please enter an email address first.');
                return;
            }

            const { subject, body } = generateEmailContent(student, email);

            document.getElementById('modalBody').innerHTML = `
                <div style="margin-bottom: 20px;">
                    <strong>To:</strong> ${email}<br>
                    <strong>Subject:</strong> ${subject}
                </div>
                <div style="background: #f9fafb; padding: 20px; border-radius: 8px; white-space: pre-line; line-height: 1.6;">
                    ${body}
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-success" onclick="copyEmail(${index}); closeModal();">
                        üìã Copy to Clipboard
                    </button>
                </div>
            `;

            document.getElementById('emailModal').style.display = 'block';
        }

        function copyEmail(index) {
            const email = document.getElementById(`email-${index}`).value;
            const student = STUDENTS_DATA[index];

            if (!email) {
                alert('Please enter an email address first.');
                return;
            }

            const { subject, body } = generateEmailContent(student, email);

            const emailContent = `To: ${email}
Subject: ${subject}

${body}`;

            navigator.clipboard.writeText(emailContent).then(() => {
                alert('Email copied to clipboard! You can now paste it into your email client.');
            }).catch(err => {
                console.error('Failed to copy email: ', err);
                alert('Failed to copy email. Please try again.');
            });
        }

        function generateAllEmails() {
            for (let i = 0; i < STUDENTS_DATA.length; i++) {
                generateEmailPreview(i);
            }

            document.getElementById('successMessage').style.display = 'block';
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'none';
            }, 5000);
        }

        function copyAllEmails() {
            let allEmails = '';
            let emailCount = 0;

            for (let i = 0; i < STUDENTS_DATA.length; i++) {
                const email = document.getElementById(`email-${i}`).value;
                const student = STUDENTS_DATA[i];

                if (email) {
                    const { subject, body } = generateEmailContent(student, email);
                    allEmails += `=== EMAIL ${++emailCount} ===
To: ${email}
Subject: ${subject}

${body}

========================

`;
                }
            }

            if (allEmails) {
                navigator.clipboard.writeText(allEmails).then(() => {
                    alert(`${emailCount} emails copied to clipboard! You can now paste them into your email client.`);
                });
            } else {
                alert('Please enter at least one email address first.');
            }
        }

        function closeModal() {
            document.getElementById('emailModal').style.display = 'none';
        }

        function updateProgress() {
            // This function could be used to show progress of sent emails
            const total = STUDENTS_DATA.length;
            let sent = 0;

            for (let i = 0; i < total; i++) {
                if (document.getElementById(`sent-${i}`).checked) {
                    sent++;
                }
            }

            // You could update a progress bar here if desired
            console.log(`Progress: ${sent}/${total} emails sent`);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('emailModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeStudentInputs);
    </script>
</body>
</html>